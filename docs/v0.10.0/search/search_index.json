{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Getting Started","text":""},{"location":"#why-should-you-use-the-framework","title":"Why should you use the framework?","text":"<p>It is not 100% necessary to use a framework, but especially PHP code is usually very messy. This is mostly because the language allows for so many formatting and usage habits, that might not reflect best practices. This adds up. Using a good framework vastly improves your style, but that is not it yet. The biggest advantage is, that the Z_Framework adds multiple layers of abstraction on top of PHP. This allows you to create webapps in record time. Even an empty project is already capable of a login system, a dashboard, a sitemap, PDF generation, HTML templating, etc. while disregarding all the programming based features.</p>"},{"location":"#using-mvc","title":"Using MVC","text":"<p>Using this framework effectively, you must use the MVC pattern, which consists of  * Controllers handle all the logic within your program. They do the actual computational work.  * Models handle all interactions with your data structure. This could be referring to a database as well as file or else. * Views are basically templates of your content, which get propagated with the results of your controllers.</p>"},{"location":"#wiki-and-technical-documentation","title":"Wiki and technical documentation","text":"<p>This wiki provides a general overview about most framework features and best practice related topics, but if you need something more technical that explains every file, class, method and their parameters, please refer to zdoc.</p>"},{"location":"advanced-features/aliases-and-virtual-links/","title":"Using aliases within virtual links","text":""},{"location":"advanced-features/aliases-and-virtual-links/#explanation","title":"Explanation","text":"<p>If would like to have short or  other versions of your virtual links, you can use aliases. To create a new alias, use the reroute method.  More about the reroute method can be found in the zdoc. Set the second parameter to true. This turns the reroute into an alias reroute. The current path will then be replaced with the first argument, but will not be truncated.</p>"},{"location":"advanced-features/aliases-and-virtual-links/#example","title":"Example","text":"<p>Only the first part of the URL get rerouted. The rest stays untouched.</p>"},{"location":"advanced-features/aliases-and-virtual-links/#code","title":"Code","text":"<p><code>$res-&gt;reroute([\"ws\"], true);</code></p>"},{"location":"advanced-features/aliases-and-virtual-links/#result","title":"Result","text":"<pre><code>Before:\n/workspace/upload/endpoint/\n\nAfter:\n/ws/upload/endpoint/\n</code></pre>"},{"location":"advanced-features/sitemap-generation/","title":"Using the Sitemap","text":""},{"location":"advanced-features/sitemap-generation/#a-description-of-the-feature","title":"A description of the feature","text":"<p>Websites usually have some kind of sitemap. Basically, they are just a list of availible links on a website or webapp and make it easier for search engines to index all of the links, even those that are not linked to. </p>"},{"location":"advanced-features/sitemap-generation/#how-to-auto-generate-them","title":"How to auto generate them","text":"<p>The framework is able to auto generate the sitemap. To open it, simply use <code>{your domain/root directory}/sitemap</code>. The default setting for any action is to not be displayed in the sitemap. You can either change the default setting by changing the key sitemapPublicDefault in the z_settings.ini file or by adding an attribute for each attribute foreach action you want displayed in the sitemap.</p> <p>An attribute to enable the sitemap for an actions needs to look like the following:</p> Access Modifyer Storage Class $ and the action name The Setting Value public static $action_test _sitemap = true; <pre><code>Result:\npublic static $action_test_sitemap = true;\n</code></pre> <p>If you are using <code>action_fallback</code>, you can also pass a string array instead of a simple true. Every entry in this array will than be interpreted as a unique link.</p>"},{"location":"core-features/configuration/","title":"The Booter Settings","text":""},{"location":"core-features/configuration/#what-is-this","title":"What is this?","text":"<p>The booter settings are a way of getting your most basic settings. If you have something like the uploads folder or the database connection, that might be changed by a customer/admin after finishing this project, those values can be stored under your <code>z_config folder</code> as a key of <code>z_settings.ini</code>.</p>"},{"location":"core-features/configuration/#how-to-use-it","title":"How to use it","text":"<p>If you want to use another key, simply create a new key in your <code>z_settings.ini</code>. To recall the value use <code>$res-&gt;getBooterSettings(\"key\")</code>. If you don't pass a key, the whole array of values will be returned.</p>"},{"location":"core-features/controllers-and-actions/","title":"Getting Started: Controllers and Actions","text":""},{"location":"core-features/controllers-and-actions/#what-does-a-controller-do","title":"What does a controller do?","text":"<p>A controller is one part of the MVC pattern. It handles all the logic, but what does that mean? Usually the controller takes in data from one or multiple models as well as user input and does something with it. This could include sorting, searching, calculating and generally making the data ready to display or ready to put into the database in case of a form input for example. </p>"},{"location":"core-features/controllers-and-actions/#how-to-get-a-controller-executed","title":"How to get a controller executed?","text":"<p>Since there are no actual paths, controllers are tightly bound to the requested url. The first part of the URL, that is not part of getting to your project's root directory, determines which Controller will be used. If you call your controller IndexController, it will be executed when no name is given by a reuqest. </p>"},{"location":"core-features/controllers-and-actions/#what-are-actions","title":"What are actions?","text":"<p>Actions are basically the second part of the URL. After choosing a controller, the framework tries to find the requested method from the URL in that controller and than executes it. There are some magic action names, that are reserved for different functionalities:</p> Name Description action_index Will be executed if no action is specified in the request. action_fallback Will be executed when the requested action is not found. Can be used to have infinite actions."},{"location":"core-features/controllers-and-actions/#examplecontrollerphp","title":"ExampleController.php","text":"<p>The following function <code>action_test</code> will be executed when requesting the path <code>{root}/example/test/{parameters}</code>. <pre><code>&lt;?php\n    class ExampleController extends z_controller {\n\n        public function action_test($req, $res) {\n\n        }\n\n    }\n?&gt;\n</code></pre></p>"},{"location":"core-features/layouts/","title":"Using a layout in your project","text":""},{"location":"core-features/layouts/#what-is-a-layout","title":"What is a layout?","text":"<p>When talking about a layout, a reusable page structure is meant. To an extend, most content pages look very similar. Think Navigation or Footer. A perfect opportunity for generalization.</p>"},{"location":"core-features/layouts/#how-to-use-one-in-your-project","title":"How to use one in your project?","text":"<p>When using <code>$res-&gt;render</code>, a third optional parameter accepts a path to a layout. See the zdoc for a more detailed description of the method. If no parameter is given, the render engine will look for a layout with the standard name in your views folder. The standard location for a layout is: <code>{your z_views folder}/layout/default_layout.php</code>. If you wish to use a different location, you'll need to use the third parameter to specify a different path. This also allows you to use multiple layouts within the same project and even switch dynamically for content pages. </p>"},{"location":"core-features/layouts/#example-layout","title":"Example layout","text":"<pre><code>&lt;?php  return [\"layout\" =&gt; function($opt, $body, $head) { ?&gt;\n    &lt;!doctype html&gt;\n    &lt;html class=\"no-js\" lang=\"en\"&gt;\n        &lt;head&gt;\n            &lt;?php $opt[\"layout_essentials_head\"]($opt); ?&gt;\n            &lt;?php $head($opt); ?&gt;\n        &lt;/head&gt;\n        &lt;body&gt;\n            &lt;?php $body($opt); ?&gt;\n            &lt;?php $opt[\"layout_essentials_body\"]($opt); ?&gt;\n        &lt;/body&gt;\n    &lt;/html&gt;\n&lt;?php }, \"lang\" =&gt; [\n    \"en\" =&gt; [\n        \"key\" =&gt; \"word\",\n        \"key2\" =&gt; \"word2\"\n    ],\n    \"DE_Formal\" =&gt; [\n        \"key\" =&gt; \"wort\",\n        \"key2\" =&gt; \"wort2\"\n    ]\n]]; ?&gt;\n</code></pre>"},{"location":"core-features/localization/","title":"Translations for multiple languages","text":"<p>The framework has functions to create the same pages in multiple languages from one view. Nothing outside the view needs to be changed to use this feature. The system is simple and can only match sentences to keys. Its not possible to do advanced stuff like getting plural forms automatically.</p>"},{"location":"core-features/localization/#defining-keys","title":"Defining keys","text":"<p>To define language keys, add a <code>lang</code> index to your view return array. In <code>lang</code> you can add multiple languages and keys to them. <pre><code>return [\n    \"head\" =&gt; function($opt) { ... },\n    \"body\" =&gt; function($opt) { ... },\n    \"lang\" =&gt; [\n        \"de\" =&gt; [\n            \"roles\" =&gt; \"Rollen\",\n            \"name\" =&gt; \"Name\",\n            \"permissions\" =&gt; \"Berechtigungen\",\n            \"permission\" =&gt; \"Berechtigung\",\n            \"delete_confirm\" =&gt; \"M\u00f6chten Sie wirklich die Rolle l\u00f6schen?\",\n            \"delete\" =&gt; \"Rolle L\u00f6schen\"\n        ],\n        \"en\" =&gt; [\n            \"roles\" =&gt; \"Roles\",\n            \"name\" =&gt; \"Name\",\n            \"permissions\" =&gt; \"Permissions\",\n            \"permission\" =&gt; \"Permission\",\n            \"delete_confirm\" =&gt; \"Do you really want to delete this role?\",\n            \"delete\" =&gt; \"Delete role\"\n        ]\n    ]\n];\n</code></pre> Keys can also be defined inside the layout. Then they will be available in all views using that layout. To do that simply, add this lang index in the return array of the layout.</p>"},{"location":"core-features/localization/#using-keys","title":"Using keys","text":"<p>In the view you can access the keys with the <code>lang</code> method in <code>opt</code>. <pre><code>&lt;span&gt;&lt;?php $opt[\"lang\"](\"roles\") ?&gt;: 5&lt;/span&gt;\n</code></pre> <code>$opt[\"lang\"]($key, $doEcho)</code> will echo the value by default. If the second parameter is set to false, the value will be returned instead of echoed.</p>"},{"location":"core-features/models/","title":"Getting Started: Models","text":""},{"location":"core-features/models/#what-does-a-model-do","title":"What does a model do?","text":"<p>A model depicts all interactions with your data structure. This is usually either the database or a file. The model can be used to retrieve data as well as set it.</p>"},{"location":"core-features/models/#how-to-use-it","title":"How to use it","text":"<p>If you have already created a model, you can simply use <code>$req-&gt;getModel(\"mMdelname\")</code></p>"},{"location":"core-features/models/#built-in-functionality","title":"Built-In Functionality","text":"<p>Every model iherties all of these methods from the z_model class. You can simply use the already existing methods and build on them. </p>"},{"location":"core-features/models/#example-model","title":"Example Model","text":"<pre><code>&lt;?php\n    class ExampleModel extends z_model {\n\n        public function getTest() {\n\n        }\n\n    }\n?&gt;\n</code></pre>"},{"location":"core-features/models/#example-database-request","title":"Example Database Request","text":"<p>The method <code>exec</code> is probably the most important one for your model. It incorporates all the steps for a prepared statement in one simple line. The first parameter is the sql command as a variable or string literal. The second parameter is a string literal of all the variable types. Each char represents one variable. All parameters afterwards are expected to be variables and replace the question marks within the sql command.</p>"},{"location":"core-features/models/#prepared-types","title":"Prepared types","text":"Type Description Use Cases i An integer Mostly IDs, but also other numeric values s A string Names, Dates, Emails d A double A rational number b A blob Binary data like an image. (Don't use this)"},{"location":"core-features/models/#code","title":"Code","text":"Why not simply write queries without question marks? <p>When not preparing your variables, it is very likely that your code is vulnerable to SQl injections, one of the most common security mistakes made when dealing with databases. </p> <p>If you always use exec with the question marks in your queries, you save yourself from a lot of headaches. </p> <p>Learn more about SQL injections from the official PHP documentation. An interesting and even partly entertaining read. </p> <pre><code>$sql = \"YOUR COMMAND ?, ?\";\n$this-&gt;exec($sql, \"si\", $stringVar, $intVar);\nreturn $this-&gt;resultToArray();\n</code></pre>"},{"location":"core-features/parameter-abstraction/","title":"Parameters, post, get, file and cookies","text":""},{"location":"core-features/parameter-abstraction/#url-parameters","title":"URL Parameters","text":"<p>When using virtual links, parameters as \u201csubfolders\u201d is a great way of transfering values, that are also very readable. See the following link schema as an example of what is meant by parametres within the virtual link: <code>controller/action/param0/param1/param2/...</code></p>"},{"location":"core-features/parameter-abstraction/#read-the-parameters-using-code","title":"Read the parameters using code","text":"<p>To read the virtual url parameters use <code>$req-&gt;getParameters</code>. It works using an offset and a length, but can also use a value to compare against if the length is one.</p>"},{"location":"core-features/parameter-abstraction/#examples","title":"Examples","text":"<p>Example URL: <code>www.yourwebsite.com/{controller}/{action}/a/b/c</code></p> <p>Get the first parameter: <code>$req-&gt;getParameters(0, 1);</code> Returns: \"a\"</p> <p>Get all the parameters after the second one: <code>$req-&gt;getParameters(1);</code> Returns: [\"b\", \"c\"]</p> <p>Check if the first parameter is \"test\": <code>if($req-&gt;getParameters(0, 1, \"test\");) {</code> ... Returns: false</p> <p>Get the first parameter when using a fallback action <code>$req-&gt;getParameters(-1, 1);</code> Returns \"action\"</p>"},{"location":"core-features/parameter-abstraction/#get-post-cookies-file-as-a-method","title":"GET, POST, COOKIES, FILE as a method","text":"<p>The framework includes some extra functionality when it comes to the above mentioned features and you should use the framework instead of the traditional way. This is because the framework employes extra filtering and processing methods as well as error handling already for you.</p>"},{"location":"core-features/parameter-abstraction/#getting-post-and-get-parameters","title":"Getting POST and GET parameters","text":"<p><code>$req-&gt;getGet</code> and <code>$req-&gt;getPost</code> are methods to get form parameters. These also enable to set default parameters if some are not set. Note: Post parameters get decoded automatically if their values have a special prefix like <code>&lt;#decb64#&gt;</code> or <code>&lt;#decURI#&gt;</code>. This decoding allows to transmit special characters.</p>"},{"location":"core-features/parameter-abstraction/#cookies","title":"Cookies","text":"<p><code>$req-&gt;getCookie</code> gets a cookie. It has a second parameter to set a default if the cookie is not set.</p> <p><code>$res-&gt;setCookie</code> has the same parameters as the native <code>setcookie</code> function of php. It should be used, because in the future may more logic build into the framework that deals with cookies.</p> <p><code>$res-&gt;unsetCookie</code> is an advanced method to remove cookies from the client.</p>"},{"location":"core-features/parameter-abstraction/#file","title":"File","text":"<p><code>$req-&gt;getFile</code> uses <code>$_FILE</code> like <code>$req-&gt;getPost</code> uses <code>$_POST</code>.</p>"},{"location":"core-features/permission-system/","title":"Using the permission system","text":""},{"location":"core-features/permission-system/#roles","title":"Roles","text":"<p>Roles are the things that holds permissions. A role can be created with the Z-Admin panel. For a user to have access to the permissions of the role it needs to have the role assigned. The assignment can also be done with the Z-Admin panel.</p>"},{"location":"core-features/permission-system/#structure-of-a-permission","title":"Structure of a permission","text":"<p>Permissions are structured as multiple keywords connected by periods. For example: <code>admin.user.create</code>. This is descriptive as it can be seen that this permission is for admins with access to the user management and creating users. This style of writing permissions allows also the usage of wildcards. To <code>admin.user.create</code> someone with these permissions will have access to it: <code>*.*</code>, <code>admin.*</code>, <code>amdin.user.*</code> and <code>admin.user.create</code>. <code>*.*</code> is a wildcard for all permissions. Use it on you own risk.</p>"},{"location":"core-features/permission-system/#blocking-forbidden-pages","title":"Blocking forbidden pages","text":"<p>The Request object has a method called <code>checkPermission</code>. By calling it, all users without the permission given as the parameter will be rerouted to the 403 page and the current request will be cancled. So it is wise to call this at the very beginning of an action.</p>"},{"location":"core-features/permission-system/#example","title":"Example:","text":"<pre><code>//Kicks the current request out of the action when it does not have \"admin.danger.cfg\"\n$req-&gt;checkPermission(\"admin.danger.cfg\");\n</code></pre>"},{"location":"core-features/permission-system/#checking-permissions-while-rendering-the-page","title":"Checking permissions while rendering the page","text":"<p>To check if the requesting user has a permission, the user object in <code>$opt</code> can be used. It has a method called <code>checkPermission</code> that returns a boolean. Note that this is another method than <code>checkPermission</code> from the request object. This one does not redirect the user and can be used for example to determin if specific should be visible to the user on a page it generally has access to.</p>"},{"location":"core-features/permission-system/#example_1","title":"Example:","text":"<pre><code>if ($opt[\"user\"]-&gt;checkPermission(\"admin.danger.cfg\")) {\n    //This anchor will only be shown when the accessing user has the \"admin.danger.cfg\" permission\n    ?&gt;&lt;a href=\"adminpage\"&gt;To admin page&lt;/a&gt;&lt;?php  \n}\n</code></pre>"},{"location":"core-features/rest-api/","title":"REST Responses","text":""},{"location":"core-features/rest-api/#what-is-this","title":"What is this?","text":"<p>As the client and the server are completely separated, they need to have a way communicated. It is basically a standardized way of transfering, in our case JSON data, from the server to the client.</p>"},{"location":"core-features/rest-api/#how-to-use-this","title":"How to use this?","text":"<p>There is a file called <code>z_rest.php</code>, which handles all the REST responses. You'll probably not be using this as another layer of abstraction exists within the response class. There are two functions regarding this topic. </p> Call zdoc <code>$res-&gt;generateRest</code> Here <code>$res-&gt;generateRestError</code> Here <p>You can also just use generateRest for errors. If the key result is set with the value error, it is automatically converted into a REST Error. The second parameter of generateRest called $die determines if the script exits after generating the REST response. The parameter is optional with a default value of true.</p>"},{"location":"core-features/rest-api/#example-call","title":"Example Call","text":"<pre><code>$res-&gt;generateRest([\n    \"result\" =&gt; \"error\"\n]);\n</code></pre>"},{"location":"core-features/views/","title":"Getting Started: Views","text":""},{"location":"core-features/views/#what-does-a-view-do","title":"What does a view do?","text":"<p>A view contains the html the user should see. All additional resources like css, images or javascript are also loaded from views. Views do usually not contain a footer, navigation, header or other elements that belong to the overall layout of the page. For this, layouts should be used as without a layout, a view can't be renderer. Read more about layouts here.</p> <p>Database access and heavy logic should not be used in the view as that belong into other parts of the application.</p>"},{"location":"core-features/views/#structure","title":"Structure","text":"<p>A view should be placed in the <code>z_views</code> directory of your project, otherwise it will not be found when called from the render method.</p> <p>It is a php file which returns an array with up to three attributes. <code>head</code> and <code>body</code> are functions that get executed in the layout at the matching place. <code>lang</code> is optional and holds language data useable by <code>$opt[\"lang\"]</code>.</p> <p><code>head</code> and <code>body</code> should accept a parameter called $opt. It contains data passed into the $opt parameter of the <code>render</code> method. For the view to communicate back to a controller, asynchronous methods must be used.</p>"},{"location":"core-features/views/#example-view","title":"Example view","text":"<p>This is how the file of a basic empty view looks like: <pre><code>&lt;?php return [ \"head\" =&gt; function($opt) { ?&gt;\n\n&lt;?php }, \"body\" =&gt; function($opt) { ?&gt; \n\n&lt;?php }, \"lang\" =&gt; [\n    \"en\" =&gt; [\n        \"key1\" =&gt; \"word1\"\n    ],\n    \"DE_Formal\" =&gt; [\n        \"key1\" =&gt; \"wort1\"\n    ]\n]]; ?&gt;\n</code></pre></p> <p>More examples for views can be found in <code>z_framework/default/views</code>.</p>"},{"location":"forms/auto-form-validation/","title":"Auto form validation and database updates","text":"<p>This framework has the ability to create automatic generated forms with user feedback. These forms can be validated automatically on the server and if errors occur the feedback is sent back to the user. If no errors occur the data can be used to update a database table.</p>"},{"location":"forms/auto-form-validation/#front-end","title":"Front-end","text":"<p>To create the form on the frontend, use the Z.js library. An example form can be created with this code: <pre><code>var form = Z.Forms.create({dom: \"form\"});\n\nvar inputEmail = form.createField({\n    name: \"email\", \n    type: \"email\", \n    text: \"&lt;?php $opt[\"lang\"](\"email\"); ?&gt;\", \n    value: \"&lt;?php echo $opt[\"email\"]; ?&gt;\"\n});\n\nvar inputLanguage = form.createField({\n    name: \"languageId\", \n    type: \"select\", \n    text: \"&lt;?php $opt[\"lang\"](\"language\"); ?&gt;\", \n    value: \"&lt;?php echo $opt[\"language\"]; ?&gt;\", \n    food: &lt;?php echo $opt[\"languages\"]; ?&gt;\n});\n</code></pre> The form is created with <code>Z.Forms.create</code>. The <code>dom</code> attribute takes the id of an html element in which the form in embedded. For this to work the element needs to be loaded so this script should not execute directly at the start of the page. If the element will spawns later the form can be added to it with the dom attribute <code>element.appendChild(form.dom);</code>.</p> <p><code>form.createField()</code> creates a new input field. <code>name</code> corresponds to the name in the post request. <code>type</code> is the input type. Any valid html standard type, textarea and select are possible values. This will not have any effect on how the values are parsed at the server. <code>text</code> is the label text. <code>value</code> is the default value. <code>food</code> is only required for selects. It describes what options are available. It needs to be an array formatted like this: <code>[{value: 1, text: \"one\"}, {value: 2, text: \"two\"}, ...]</code>. This array can be created at the backend with <code>$controller-&gt;makeFood</code>.</p> <p>If the type of a form element is <code>button</code> it can be styled with the <code>style</code> attribute. The values for this attribute are the default bootstrap button classes like <code>btn-primary</code> or <code>btn-secondary</code>.</p> <p>The <code>width</code> attribute can be used to set the width of form element. It is in 1/12 units of the full width and equivalent to the bootstrap column classes. This width value is only used on medium devices or larger. On small devices, the width is always 100% / 12.</p> <p>With the <code>attributes</code> attribute it is possible to define attributes for the generated input element. Attributes like <code>min</code> or <code>max</code> for a number input. Example:  <pre><code>form.createElement({name: \"zahl\", type: \"number\", attributes: {min: 0, max: 100, step: 10}});\n</code></pre></p> <p>The return value if <code>form.createField</code> is the created field. It has an attribute called <code>input</code> which can be used to access the dom input element directly. It also has <code>on</code> which is an alias for addEventListener on the input dom element. The value can be read and set with <code>value</code>.</p> <p>A separator between form inputs can be added with <code>form.createSeperator();</code>. This will insert a simple <code>&lt;hr&gt;</code> element at the end of the current builded form.</p>"},{"location":"forms/auto-form-validation/#back-end","title":"Back-end","text":"<p>When the form is submitted, it will send an asynchronous post request to the current action specified by the current users url. To check in the action if the current request is from a form, <code>$req-&gt;hasFormData()</code> can be used. This is example code for handling a form: <pre><code>if ($req-&gt;hasFormData()) {\n    $formResult = $req-&gt;validateForm([\n        (new FormField(\"email\"))        -&gt; required() -&gt; filter(FILTER_VALIDATE_EMAIL) -&gt; unique(\"z_user\", \"email\", \"id\", $userId),\n        (new FormField(\"languageId\"))   -&gt; required() -&gt; exists(\"z_language\", \"id\")\n    ]);\n\n    if ($formResult-&gt;hasErrors) {\n        $res-&gt;formErrors($formResult-&gt;errors);\n    } else {\n        $res-&gt;updateDatabase(\"z_user\", \"id\", \"i\", $userId, $formResult);\n        $res-&gt;success();\n    }\n}\n</code></pre> <code>$req-&gt;validateForm()</code> validates incoming data. As the first parameter it takes an array of fields to validate. To these field, rules can be attached. For more information see <code>FormField</code>. If no form error occurs, <code>$formResult-&gt;hasErrors</code> will be false. Else the errors should be send back to the client with <code>$res-&gt;formErrors()</code>. When everything works fine <code>$res-&gt;success()</code> should be called to signalize the client a success. Else it will show an save error. </p> <p>Success will exit the current action. So before calling it the data should be processed by a model or <code>$res-&gt;updateDatabase()</code>. Update database will take the result object from the form validation to get the names in the database. If the name in the database column and the post differ, the database name can be set by the second parameter of the constructor of FormField.</p> <p><code>$res-&gt;insertDatabase()</code> can also be used to process the data. This method will create a dataset in a table given as argument. It works similar to <code>$res-&gt;updateDatabase()</code>.</p>"},{"location":"forms/auto-form-validation/#example-advanced-layout","title":"Example advanced layout","text":"<p>Code: <pre><code>&lt;h2&gt;Testpage&lt;/h2&gt;\n\n&lt;div id=\"form\"&gt;&lt;/div&gt;\n\n&lt;script&gt;\n  var form = Z.Forms.create({dom: \"form\"});\n\n  form.createField({\n      name: \"input_email\", \n      type: \"email\",    \n      text: \"Some mail address\", \n      required: true,      \n      width: 6, \n      placeholder: \"email@blubs.de\"\n  });\n\n  form.createField({\n      name: \"input_date\",  \n      type: \"date\",     \n      text: \"Some random date\",                       \n      width: 6\n  });\n\n  var but = form.createField({\n      name: \"button\",      \n      type: \"button\", \n      value: \"Set number = 4\", \n      style: \"btn-secondary\",  \n      width: 2\n  });\n\n  var num = form.createField({\n      name: \"number\",      \n      type: \"number\",   \n      text: \"Give me a number\", \n      required: true,       \n      width: 10,\n      attributes: {\n          min: 1,\n          max: 10,\n          step: 2\n      }\n  });\n\n  form.createField({\n      name: \"range\",       \n      type: \"textarea\", \n      text: \"Textarea\", \n      value: \"Hello o/\"\n  });\n\n  form.createField({\n      name: \"file\",        \n      type: \"file\",     \n      text: \"File upload\"\n  });\n\n  but.on('click', () =&gt; {\n    num.value = 4;\n  });\n&lt;/script&gt;\n</code></pre> Result: </p>"},{"location":"forms/ced-validation/","title":"Auto form validation using CED","text":"<p>Some forms require the user to input multiple values into one field. Or to create multiple blocks or something. For every case this happens the CED system can be used. CED stands for **C**reate **E**dit **D**elete. It builds on top of the form system.</p>"},{"location":"forms/ced-validation/#front-end","title":"Front-end","text":"<p>This is an example for adding permissions to a group. It is possible to have n permissions per group. <pre><code>var form = Z.Forms.create({dom: \"form\"});\n\nform.createCED({\n    name: \"permissions\",\n    text: \"&lt;?php $opt[\"lang\"](\"permissions\"); ?&gt;\",\n    fields: [{ \n        name: \"name\", \n        type: \"text\", \n        text: \"&lt;?php $opt[\"lang\"](\"permission\"); ?&gt;\"\n    }],\n    value: &lt;?php echo $opt[\"permissions\"]; ?&gt;\n});\n</code></pre> <code>form.createCED</code> is a method from ZForm. It takes the same parameters as <code>form.createField</code>. The only special one is <code>fields</code>. <code>fields</code> takes an array of form field parameters. All form fields are build like in <code>form.createField</code>.</p> <p><code>value</code> takes an value created by <code>$controller-&gt;makeCEDFood()</code>.</p> <p>To create more compact forms, the attribute <code>compact</code> can be set to true. On form fields it will hide the label. In CED's it allows to have the remove button at the right. When using the compact mode, the inputs should have a total combined length of 11 units because the remove button will take exactly one.</p>"},{"location":"forms/ced-validation/#back-end","title":"Back-end","text":"<p>The backend code for the example mentioned before: <pre><code>if ($req-&gt;hasFormData()) {\n\n    $formResult = $req-&gt;validateCED(\"permissions\", [\n        (new FormField(\"name\")) -&gt; required() -&gt; length(3, 100)\n    ]);\n\n    if ($formResult-&gt;hasErrors) {\n        $res-&gt;formErrors($formResult-&gt;errors);\n    } else {\n        $res-&gt;doCED(\"z_role_permission\", $formResult, [\"role\" =&gt; $roleId]);\n        $res-&gt;success();\n    }\n}\n</code></pre> <code>$req-&gt;validateCED</code> takes the name of the CED field at the frontend as the first parameter. The second parameter is equal to the ruleset in <code>$req-&gt;validateForm</code>. The difference here is that the rules will be applied for all items in the ced. The return value can also be used like of the normal <code>validateForm</code> method for error reporting.</p> <p>Instead of <code>$res-&gt;updateDatabase</code>, CED's use <code>$res-&gt;doCED</code> to update the database. The first parameter is the name of the table. It is important that the table has a field named <code>active</code>. This will be used to deterime if a dataset was removed. The other fields should have the same names as the subinputs of the form.</p>"},{"location":"forms/file-uploads/","title":"Working with file uploads","text":""},{"location":"forms/file-uploads/#manual","title":"Manual","text":"<p>Sometimes it is needed that a user uploads a file. To handle incoming files, response has the <code>upload()</code> method. It returns a <code>z_upload</code> object which has more methods to handle with uploads.</p> <pre><code>$upload = $res-&gt;upload();\nif ($upload-&gt;upload($_FILES[\"file\"], \"uploads/\", FILE_SIZE_100GB, [\"txt\", \"jpg\", \"png\"])) {\n    $res-&gt;error();\n}\n\n$fileId = $upload-&gt;fileId;\n</code></pre> <p><code>$file</code> is the file in <code>$_FILES</code>. <code>$uploadDir</code> is the directory to place the file in. Ending with <code>/</code>. <code>$maxSize</code> is the max file size. For some values there are already constants in the framework. <code>$typeArray</code> array of accepted file types.</p>"},{"location":"forms/file-uploads/#using-z-forms","title":"Using Z-Forms","text":"<p>When using Z-Forms, files will be stored and error feedback automatically goes back to the user. For file uploads there is the special rule <code>file()</code>. <pre><code>(new FormField(\"file\")) -&gt; file(FILE_SIZE_1MB, [\"txt\", \"jpg\", \"png\"])\n</code></pre> Files uploaded with this method will always be moved into the \"uploads/\" directory.</p>"},{"location":"frontend-integration/backend-requests/","title":"Using Z.Request","text":"<p>The default JavaScript API of this framework does have a function to send asynchronous requests to the server and get data back.</p>"},{"location":"frontend-integration/backend-requests/#front-end","title":"Front-end","text":"<p><pre><code>Z.Request.action(\"add\", {op1: 3, op2: 6}, (response) =&gt; {\n    if (response.result == \"success\") {\n        alert(\"The sum of 3 and 6 is \" + response.sum);\n    }\n});\n</code></pre> <code>Z.Request.action</code> takes three parameters. The first one is the identifier of the action as string. The second is a object containing post parameters. The third is a callback which only parameter is the REST response of the server.</p>"},{"location":"frontend-integration/backend-requests/#back-end","title":"Back-end","text":"<p><pre><code>if ($req-&gt;isAction(\"sum\")) {\n    //Here you have access to the server. This is usually the reason we want to use this.\n    $sum = $req-&gt;getPost(\"op1\") + $req-&gt;getPost(\"op2\");\n    $res-&gt;generateRest([\"result\" =&gt; \"success\", \"sum\" =&gt; $sum]);\n}\n</code></pre> <code>$req-&gt;isAction()</code> detects if this Request was initiated by an async action call with a specified identifier. Note that these actions are not the same as the ones in the controller. They work a level higher. <code>$res-&gt;generateRest</code> will create a parsable answer for the client.</p>"},{"location":"frontend-integration/presets/","title":"Z Preset: Login and Register","text":"<p>The default JavaScript API of this framework (which is included in all views using a properly setup layout) contains presets for some core functionality of a web page.</p> <p>For these two examples it is important that the default loginController is used.</p>"},{"location":"frontend-integration/presets/#creating-a-login","title":"Creating a login","text":"<p>This is the basic layout for a login page: <pre><code>&lt;div id=\"login-error-label\"&gt;&lt;/div&gt;\n\n&lt;label for=\"input-email\"&gt;Email: &lt;/label&gt;\n&lt;input id=\"input-email\" type=\"email\"&gt;\n\n&lt;label for=\"input-password\"&gt;Password: &lt;/label&gt;\n&lt;input id=\"input-password\" type=\"password\"&gt;\n\n&lt;button id=\"button-login\"&gt;Log in&lt;/button&gt;\n\n&lt;script&gt;\n    document.getElementById(\"button-login\").addEventListener(\"click\", () =&gt; {\n        Z.Presets.Login(\"input-email\", \"input-password\", \"login-error-label\");\n    });\n&lt;/script&gt;\n</code></pre> For this to work, three elements are needed. One error output label for reporting to the user if the login failed, and two inputs. The labels are technically not needed here as well as the button.</p> <p>To trigger the login action there is the function <code>Z.Presets.Login</code>. It takes the ids of the DOM elements as inputs.</p> <p>Optionally a fourth argument can be passed into the login function that gives the url to redirect to after a successfull login. This parameter should be absolute. Example: <pre><code>document.getElementById(\"button-login\").addEventListener(\"click\", () =&gt; {\n    Z.Presets.Login(\"input-username\", \"input-password\", \"login-error-label\", \"&lt;?php echo $opt[\"root\"]; ?&gt;\");\n});\n</code></pre></p>"},{"location":"frontend-integration/presets/#creating-a-signup-form","title":"Creating a signup form","text":"<p>This is the basic layout for a singup page: <pre><code>&lt;div id=\"login-error-label\"&gt;&lt;/div&gt;\n\n&lt;label for=\"input-email\"&gt;Username: &lt;/label&gt;\n&lt;input id=\"input-username\" type=\"text\"&gt;\n\n&lt;label for=\"input-password\"&gt;Password: &lt;/label&gt;\n&lt;input id=\"input-password\" type=\"password\"&gt;\n\n&lt;label for=\"input-password-confirm\"&gt;Confirm Password: &lt;/label&gt;\n&lt;input id=\"input-password-confirm\" type=\"password\"&gt;\n\n&lt;button id=\"button-signup\"&gt;Sign up&lt;/button&gt;\n\n&lt;script&gt;\n    document.getElementById(\"button-signup\").addEventListener(\"click\", () =&gt; {\n        Z.Presets.Signup(\"input-username\", \"input-password\", \"input-password-confirm\", \"login-error-label\", \"&lt;?php echo $opt[\"root\"]; ?&gt;\");\n    });\n&lt;/script&gt;\n</code></pre> Here the important method is <code>Z.Presets.Signup</code>. It works similar to login.</p>"},{"location":"setup/how-to-update/","title":"Updating to the newest version of the framework","text":"<p>This page assumes you are using this framework as a git submodule and you have an user account with the permission <code>admin.danger.update</code>.</p> <ol> <li>Get the newest version of the submodule by using <code>git pull</code> in the <code>z_framework</code> directory.</li> <li>Open the Z-Admin panel by opening the web page in your browser <code>yourwebsite.tld/[root/]z/</code> and log in.</li> <li>Go to the <code>Framework Update</code> page.</li> <li>Click <code>Update to framework version</code>.</li> </ol> <p>When you reload the page and the project version is the same as the framework version, everything worked fine.</p>"},{"location":"setup/installation/","title":"Installation","text":"<ol> <li>Create a new folder for your project.</li> <li>Initialize an empty Git repository using <code>git init</code></li> <li>Add the framework as a submodule using <code>git submodule add https://git.zierhut-it.de/ZubZet/framework.git z_framework</code></li> <li>Login with your account if needed.</li> <li>You are required to have your php environment variable set. Use <code>php -v</code> to check. Fix this problem first, if you get an error.</li> <li>Navigate to your project in your browser. (Don't forget to use a webserver)</li> <li>Open the folder <code>z_framework</code></li> <li>Run <code>installer.php</code></li> <li>Make sure your mysql capable service of choice is running.</li> <li>Fill out all the inputs and click Install.</li> </ol>"},{"location":"setup/upgrade/0.9.x-to-0.10.x/","title":"0.9.x to 0.10.x","text":""},{"location":"setup/upgrade/0.9.x-to-0.10.x/#installation","title":"Installation","text":"<p>The repository URL has changed. To update your submodule, run the following command in the z_framework folder.</p> SSH <p>Update to the new repo URL using SSH: <pre><code>git submodule set-url z_framework ssh://git@git.zierhut-it.de:2310/zubzet/framework.git\n</code></pre></p> HTTPS <p>Update to the new repo URL using HTTPS: <pre><code>git submodule set-url z_framework https://git.zierhut-it.de/ZubZet/framework.git\n</code></pre></p> <p>Be sure to checkout to 0.10.x afterwards! <pre><code>cd z_framework\ngit checkout 0.10.x\n</code></pre></p>"},{"location":"template-rendering-usages/generating-pdfs/","title":"Generating PDF's","text":"<p>PDF's are generated with a library called html2pdf which is based on TCPDF. A pdf can be shown to a user as a response to a request. The method for that is called <code>$res-&gt;renderPDF()</code>.</p> <p>The document the path to a view. The view is not built up like a normal view. It is a file containing a layout method thats output is given into the <code>$html2pdf-&gt;writeHTML($html)</code> method. The layout method accepts one parameter which is $opt in render.</p> <p>Example PDF response: <pre><code>$res-&gt;renderPDF(\"example.php\", [\"name\" =&gt; \"Thorsten\"], \"out.pdf\", \"I\", ['P', 'A4', 'en', true, 'UTF-8', array(20, 20, 20, 5)]);\n</code></pre></p> <p>Example PDF document: <pre><code>&lt;?php \n    function layout($opt) {\n        &lt;h1&gt;Hello,&lt;/h1&gt;\n        &lt;p&gt;I am a PDF document for &lt;?php echo $opt[\"name\"]; ?&gt;&lt;/p&gt;\n    }\n?&gt;\n</code></pre></p> <p>For more information of what is possible, see here: https://github.com/spipu/html2pdf/blob/master/doc/README.md</p>"},{"location":"template-rendering-usages/sending-an-email/","title":"Sending an email","text":"<p>To send an email there are two methods in response called <code>sendEmail()</code> and <code>sendEmailToUser()</code>.</p> <p><code>$subject</code> can be an array to serve subjects for multiple languages. <code>$document</code> is the path to a view. Any view can be used as a mail. But it is wise to create extra ones, because script stuff won't work. Be careful not to leak data that only the requested account has access to. <code>$opt</code> are parameters to pass into the view. </p> <p>This method uses <code>render()</code> internally.</p> <p>For this feature to work a mail address needs to be configured in the booter settings and a SMTP service needs to be available. PHP need to be setup correctly too.</p> <p>Example code for sending a mail: <pre><code>$res-&gt;sendEmail(\n    \"test@sd.tld\",                                         // Target address\n    [\"en\" =&gt; \"Welcome Mail\", \"de\" =&gt; \"Willkommens Mail\"],  // Subject\n    \"email_welcome.php\",                                   // Path to the email view\n    \"de\",                                                  // Language used in the email\n    [\"name\" =&gt; \"Otto\"],                                    // Options\n    \"layout/email_layout.php\"                              // Layout to use\n);\n</code></pre></p>"},{"location":"template-rendering-usages/sending-an-email/#send-to-registered-users","title":"Send to registered users","text":"<p><code>sendEmailToUser()</code> sends a mail to an user identified by its user id. The mail address and language are fetched from the database, so less information is needed.</p> <p>Exmaple:  <pre><code>$res-&gt;sendEmailToUser(\n    1,                                                             // User ID\n    [\"en\" =&gt; \"New cooking recipes!\", \"de\" =&gt; \"Neue Kochrezepte!\"], // Subject\n    \"email_recipes.php\",                                           // Path to the mail view\n    [\"r1\" =&gt; \"Cake\", \"r2\" =&gt; \"Cookies!!!\"],                        // Options\n    \"layout/email_layout.php\"                                      // Layout to use\n);\n</code></pre></p>"},{"location":"z-admin/login-as-another-user/","title":"Login: Login as another user","text":"<p>When logging in, the client exchanges it's identifier and password for a authentication token and logs in using this token from that point on. <code>$res-&gt;loginAs</code> allows you to login a current client as another user by their <code>z_user.`id`</code>. </p> <p>The authentication token will track the exec user though. using this data, you'll always know who was logged in as who. You can also set an exec_user yourself, using the second argument of loginAs. If you don't want to build the tracking yourself, just use <code>Log / Statistics</code> within the z_admin panel. You are also able to login as another user using the very same panel.</p> <p>Example: <pre><code>$res-&gt;loginAs(1, 2); //Logs the requesting session in as user 1 and marks the real user as 2.\n</code></pre></p>"},{"location":"z-admin/usage/","title":"Using the Z-Admin panel","text":"<p>The Z-Admin panel is a control panel all projects using the framework have. It is accessible with the z controller. For example, an URL like this: <code>{yourdomain.tld}/{yourwebsite}/z</code>. Only logged in accounts with the correct permissions are able to see this section.</p>"},{"location":"z-admin/usage/#categories","title":"Categories","text":"<p>It has following categories:</p> Category Function Read more Instance Simple place to change instance settings Wiki Log / Statistics View logs and statistics Framework Update Start updates for the framework Wiki Edit User Form to edit users Add User Form to add users Roles User permission managment Wiki ## Permissions To be able to use all functions, the following permissions are needed: *  admin.panel *  admin.user.list *  admin.user.add *  admin.user.edit *  admin.roles.list *  admin.roles.screate *  admin.roles.edit *  admin.roles.delete *  admin.log *  admin.su *  admin.danger.cfg *  admin.danger.update"},{"location":"z-admin/usage/#assigning-roles","title":"Assigning roles","text":"<p>In order to assign any roles, you must go to Edit Users and select the user you want to give a role to. Hit the \u2018+\u2019 under the title \u2018Roles\u2019 and select the role the user should get. Be advised, each role gives special permissions, some give the user special powers, therefore please see the list below of what roles have which permissions.</p> <p>After you set a role, you can either add more roles or save the user by clicking \u2018submit\u2019 at the bottom of the page. The user should now be able to use their role. </p>"}]}